<c-container fluid>
  <c-row class="mb-4">
    <!-- KPI Cards -->
    <c-col [xs]="12" [sm]="6" [lg]="4">
      <c-widget-stat-a color="primary" title="Total Gross Revenue">
        <!-- Assuming gross_revenue is calculated in component -->
        <span class="fs-3 fw-semibold">{{ summaryStats.totalGrossRevenue | currency:'USD':'symbol':'1.0-0' }}</span>
      </c-widget-stat-a>
    </c-col>
    <c-col [xs]="12" [sm]="6" [lg]="4">
      <c-widget-stat-a color="info" title="Total Entries">
        <span class="fs-3 fw-semibold">{{ summaryStats.totalEntries | number:'1.0-0' }}</span>
      </c-widget-stat-a>
    </c-col>
    <c-col [xs]="12" [sm]="6" [lg]="4">
      <c-widget-stat-a color="warning" title="Avg Cut per Entry">
        <span class="fs-3 fw-semibold">{{ summaryStats.avgCutPerEntry | currency:'USD':'symbol':'1.2-2' }}</span>
      </c-widget-stat-a>
    </c-col>
  </c-row>

  <!-- Revenue Over Time Chart -->
  <c-row class="mb-4">
    <c-col>
      <c-card>
        <c-card-header>Revenue Over Time</c-card-header>
        <c-card-body>
          <!-- Assuming chart data is updated in component -->
          <c-chart type="line" [data]="revenueOverTimeChartData" [options]="lineChartOptions"></c-chart>
        </c-card-body>
      </c-card>
    </c-col>
  </c-row>

  <!-- Recent Revenue Entries Table -->
  <c-row class="mb-4">
    <c-col>
      <c-card>
        <c-card-header>Recent Revenue Entries</c-card-header>
        <c-card-body>
          <div class="table-responsive">
            <table cTable class="table table-striped table-hover">
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">User</th>
                  <th scope="col">Role</th>
                  <th scope="col">Shift</th>
                  <th scope="col">Revenue</th>
                  <th scope="col">Cut</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let entry of recentRevenueEntries">
                  <td>{{ entry.date | date:'yyyy-MM-dd' }}</td>
                  <!-- Use the custom 'id' field as fallback if 'user_mention' is missing -->
                  <td>{{ entry.user_mention || entry.id || 'N/A' }}</td>
                  <td>{{ entry.role || 'N/A' }}</td>
                  <td>{{ entry.shift || 'N/A' }}</td>
                  <td>{{ entry.gross_revenue | currency:'USD':'symbol':'1.0-0' }}</td> <!-- Assuming gross_revenue field -->
                  <td>{{ entry.total_cut | currency:'USD':'symbol':'1.0-0' }}</td>
                </tr>
                <tr *ngIf="recentRevenueEntries.length === 0">
                  <td colspan="6" class="text-center">No recent entries found.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </c-card-body>
      </c-card>
    </c-col>
  </c-row>

  <!-- Quick Actions (Optional Placement) -->
  <c-row class="mb-4">
    <c-col class="text-center">
      <button cButton color="primary" class="me-2" (click)="navigateToAddEntry()">Add Revenue Entry</button>
      <button cButton color="secondary" (click)="navigateToViewAll()">View All Records</button>
    </c-col>
  </c-row>

</c-container>

<!-- Filters section -->
<c-card class="mb-4">
  <c-card-header>Filter Earnings</c-card-header>
  <c-card-body>
    <form [formGroup]="filterForm" (ngSubmit)="applyFilters()">
      <c-row class="g-3 align-items-end">
        <c-col [md]="3">
          <label cLabel for="guildFilter">Guild Name/ID</label>
          <input cFormControl id="guildFilter" type="text" formControlName="guildFilter" />
        </c-col>
        <c-col [md]="3">
          <!-- Changed label to reflect it filters by mention or ID -->
          <label cLabel for="userFilter">User Mention / ID</label>
          <input cFormControl id="userFilter" type="text" formControlName="userFilter" />
        </c-col>
        <c-col [md]="3">
          <label cLabel for="dateFilter">Date</label>
          <input cFormControl id="dateFilter" type="date" formControlName="dateFilter" />
        </c-col>
        <c-col [md]="3">
          <button cButton type="submit" color="primary" class="me-2">Apply Filters</button>
          <button cButton type="button" color="secondary" (click)="resetFilters()">Reset</button>
        </c-col>
      </c-row>
    </form>
  </c-card-body>
</c-card>
