<c-container fluid>
  <c-row class="mb-4">
    <!-- KPI Cards -->
    <!-- Adjusted col size from lg="4" to lg="3" to fit four widgets -->
    <c-col [xs]="12" [sm]="6" [lg]="3">
      <c-widget-stat-a color="primary" title="Total Gross Revenue">
        <span class="fs-3 fw-semibold">{{ summaryStats.totalGrossRevenue | currency:'USD':'symbol':'1.0-0' }}</span>
      </c-widget-stat-a>
    </c-col>
    <!-- Added Total Cut Widget -->
    <c-col [xs]="12" [sm]="6" [lg]="3">
      <c-widget-stat-a color="success" title="Total Cut">
        <span class="fs-3 fw-semibold">{{ summaryStats.totalCut | currency:'USD':'symbol':'1.0-0' }}</span>
      </c-widget-stat-a>
    </c-col>
    <c-col [xs]="12" [sm]="6" [lg]="3">
      <c-widget-stat-a color="info" title="Total Entries">
        <span class="fs-3 fw-semibold">{{ summaryStats.totalEntries | number:'1.0-0' }}</span>
      </c-widget-stat-a>
    </c-col>
    <c-col [xs]="12" [sm]="6" [lg]="3">
      <c-widget-stat-a color="warning" title="Avg Cut per Entry">
        <span class="fs-3 fw-semibold">{{ summaryStats.avgCutPerEntry | currency:'USD':'symbol':'1.2-2' }}</span>
      </c-widget-stat-a>
    </c-col>
  </c-row>

  <!-- Revenue Over Time Chart -->
  <c-row class="mb-4">
    <c-col>
      <c-card>
        <c-card-header>Revenue Over Time</c-card-header>
        <c-card-body>
          <c-chart type="line" [data]="revenueOverTimeChartData" [options]="lineChartOptions"></c-chart>
        </c-card-body>
      </c-card>
    </c-col>
  </c-row>

  <!-- Recent Revenue Entries Table -->
  <c-row class="mb-4">
    <c-col>
      <c-card>
        <c-card-header>Recent Revenue Entries</c-card-header>
        <c-card-body>
          <div class="table-responsive">
            <table cTable class="table table-striped table-hover">
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">User</th>
                  <th scope="col">Role</th>
                  <th scope="col">Shift</th>
                  <th scope="col">Revenue</th>
                  <th scope="col">Cut</th>
                </tr>
              </thead>
              <tbody>
                <!-- Ensure you are using entry.parsedDate for the DatePipe -->
                <tr *ngFor="let entry of recentRevenueEntries">
                  <td>{{ entry.parsedDate | date:'shortDate' }}</td>
                  <td>{{ entry.user_mention || 'N/A' }}</td>
                  <td>{{ entry.role || 'N/A' }}</td>
                  <td>{{ entry.shift || 'N/A' }}</td>
                  <td>{{ entry.gross_revenue | currency:'USD':'symbol':'1.0-0' }}</td>
                  <td>{{ entry.total_cut | currency:'USD':'symbol':'1.0-0' }}</td>
                </tr>
                <tr *ngIf="recentRevenueEntries.length === 0">
                  <td colspan="6" class="text-center">No recent entries found.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </c-card-body>
      </c-card>
    </c-col>
  </c-row>

</c-container>
